---
title: "JS and TS Tips"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["javascript", "typescript"]
published: false
publication_name: "gmomedia"
---


## はじめに

:::message
修正や追加等はコメントまたはGitHubで編集リクエストをお待ちしております。
:::

## 概要

JSとTSのTipsをまとめます。
簡単なものから難しいものまでをまとめています。

## 数値を判定する

数値を判定するときに、以下のようなコードでは不具合が発生します。

```js isNumber.js
const isNumber = (num) => {
  if (isFinite(num)) {
    console.log("num is truthy");
  } else {
    console.log("num is falsy");
  }
};

isNumber(null); // id is truthy
isNumber("1"); // id is truthy

```

```ts isNumber.ts
const isNumber = (num: unkown) => {
  if (isFinite(num as number)) {
    console.log("num is truthy");
  } else {
    console.log("num is falsy");
  }
};

isNumber(null); // id is truthy
isNumber("1"); // id is truthy

```

これは、jsの仕様で、`isFinite`は暗黙的に数値に変換されるためです。
このような場合は、以下のように判定する必要があります。

```js isNumber.js
const isNumber = (num) => {
  if (Number.isFinite(num)) {
    console.log("num is truthy");
  } else {
    console.log("num is falsy");
  }
};
```

```ts isNumber.ts
const isNumber = (num: unknown) => {
  if (Number.isFinite(num)) {
    console.log("num is truthy");
  } else {
    console.log("num is falsy");
  }
};
```

`Number.isFinite`は、`isFinite`と異なり、暗黙的に数値に変換されることはありません。

## typeofの落とし穴

`typeof`は型を判定するための演算子ですが、以下のような落とし穴があります。

```js isArray.js
const isArray = (arr) => {
  if (typeof arr === "object") {
    console.log("arr is truthy");
  } else {
    console.log("arr is falsy");
  }
};
```

```ts isArray.ts
const isArray = (arr: unknown) => {
  if (typeof arr === "object") {
    console.log("arr is truthy");
  } else {
    console.log("arr is falsy");
  }
};
```

この関数に`null`を渡すと、`arr is truthy`となります。
これは、`typeof null`が`object`であるためです。

このような場合は、以下のように判定する必要があります。

```js isArray.js
const isArray = (arr) => {
  if (Array.isArray(arr)) {
    console.log("arr is truthy");
  } else {
    console.log("arr is falsy");
  }
};
```

```ts isArray.ts
const isArray = (arr: unknown) => {
  if (Array.isArray(arr)) {
    console.log("arr is truthy");
  } else {
    console.log("arr is falsy");
  }
};
```

`Array.isArray`は、`typeof`と異なり、`null`を`falsy`として判定します。

## デフォルト引数の小技

前の引数を使ってデフォルト引数を設定することができます。

```js defaultArgs.js
const defaultArgs = (a, b = a) => {
  console.log(a, b);
};

defaultArgs(1); // 1 1
defaultArgs(1, 2); // 1 2
```

```ts defaultArgs.ts
const defaultArgs = (a: number, b: number = a) => {
  console.log(a, b);
};

defaultArgs(1); // 1 1
defaultArgs(1, 2); // 1 2
```
