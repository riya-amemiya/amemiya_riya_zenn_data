---
title: "Remixã‚’Cloudflare Pagesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ™‚ã«ãƒãƒã£ãŸè©±"
emoji: "ğŸ«µ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["remix","cloudflare"]
published: true
publication_name: "gmomedia"
---

## ã¯ã˜ã‚ã«

:::message
ä¿®æ­£ã‚„è¿½åŠ ç­‰ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¾ãŸã¯GitHubã§ç·¨é›†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚
:::

## Remixã‚’Cloudflare Pagesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ™‚ã«ãƒãƒã£ãŸè©±

Remixã‚’Cloudflare Pagesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ™‚ã«ãƒãƒã£ãŸã®ã§ã‚„ã£ãŸã“ã¨ã‚’æœªæ¥ã®è‡ªåˆ†ã®ãŸã‚ã«æ®‹ã—ã¦ãŠãã¾ã™

### ãã®1: ç’°å¢ƒå¤‰æ•°ã®ä»•æ§˜

Remixã®ç’°å¢ƒå¤‰æ•°ã¯ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã™ã‚‹ãŒã€Cloudflare Pagesã§ã¯ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¾ãªã„
ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ç¢ºèªæ™‚ã«ã¯ã€`.dev.vars` ãƒ•ã‚¡ã‚¤ãƒ«ã«ç’°å¢ƒå¤‰æ•°ã‚’è¨˜è¿°ã—ã¦ãŠã‹ãªã„ã¨ã„ã‘ãªã„
ã¾ãŸã€`process.env` ã¯ä½¿ãˆãšã€`context.cloudflare.env` ã‚’ä½¿ã†
ãƒãƒƒãƒˆã«ã¯ `context.env` ã¨æ›¸ã„ã¦ã‚ã‚‹è¨˜äº‹ã‚‚ã‚ã‚‹ãŒã€`context.cloudflare.env` ãŒæ­£ã—ã„
ç§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®é–‹ç™ºæ™‚ã«ã¯Bunã¨Viteã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹

```ts
// Envã¯ç’°å¢ƒå¤‰æ•°ã®å‹ã§wrangler typesã‚’å®Ÿè¡Œã™ã‚‹ã¨.dev.varsã‚’å…ƒã«ç”Ÿæˆã•ã‚Œã‚‹

export const loader = async ({ request, context }: LoaderFunctionArgs) => {
  let env: Env;
  try {
    env = process.env as unknown as Env; // ãƒ­ãƒ¼ã‚«ãƒ«ã¯nodeãªã®ã§process.env
  } catch {
    env = context.cloudflare.env as Env; // Cloudflare Pagesã¯context.cloudflare.env
  }
  if (!(env.SUPABASE_URL && env.SUPABASE_ANON_KEY)) {
    throw new Error("SUPABASE_URL or SUPABASE_ANON_KEY is not defined");
  }
  const response = new Response();

  const supabase = createServerClient(env.SUPABASE_URL, env.SUPABASE_ANON_KEY, {
    request,
    response,
  });

  const {
    data: { session },
  } = await supabase.auth.getSession();

  return json(
    {
      env,
      session,
    },
    {
      headers: response.headers,
    },
  );
};
```

### ãã®2: ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®è¨­å®š

Cloudflareã®Docsã« `Build directory public` ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ãŒã€æ­£ã—ãã¯ `./build/client` ã§ã™ã€‚
ã“ã‚Œã‚’é–“é•ãˆã‚‹ã¨CSSã‚„JSãŒèª­ã¿è¾¼ã¾ã‚Œãªã„ã®ã§æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã ã¨Bunã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ã®ã§ã€ç’°å¢ƒå¤‰æ•° `BUN_VERSION` ã‚’æŒ‡å®šã—ã¦æœ€æ–°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã†ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

https://developers.cloudflare.com/pages/framework-guides/deploy-a-remix-site/

## ã¾ã¨ã‚

ä»¥ä¸Šã€Remixã‚’Cloudflare Pagesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ™‚ã«ãƒãƒã£ãŸè©±ã§ã—ãŸã€‚
ã‚‚ã—åŒã˜å•é¡Œã«ã¶ã¤ã‹ã£ã¦ã‚‹èª°ã‹ã®åŠ©ã‘ã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

## ãŠã¾ã‘

ä½•ã‚„ã‹ã‚“ã‚„ã‚ã‚Šã¤ã¤ã€å‡ºæ¥ä¸ŠãŒã£ãŸã‚µã‚¤ãƒˆãŒã“ã¡ã‚‰

https://remix-study.oshaburikitchin.com/

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰

https://github.com/riya-amemiya/remix-study

ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨ã‹ã„ã†æ¦‚å¿µã¯æ¨ã¦ã¦ã‚‹ã®ã§ã€Todoãƒªã‚¹ãƒˆã‚’èª°ã§ã‚‚é–²è¦§ã€è¿½åŠ ã€å‰Šé™¤ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã¾ã™ã€‚
å€‹äººæƒ…å ±ã‚’å…¥åŠ›ã—ãŸã‚‰å…¨ä¸–ç•Œã«å…¬é–‹ã•ã‚Œã‚‹ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚
